# hash-only-2 - Medium
## Description
Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content!
## Solution
Phiên bản 2 có binary giống hệt phiên bản 1: 
```
std::string::basic_string(v13, "/bin/bash -c 'md5sum /root/flag.txt'", &v11);
```
Chỉ khác là biến `PATH` được set thành **read only** cùng với một số hạn chế khác (không thể cd, redirect output,...)  
Quá trình khai thác sẽ như sau:  
Tìm xem md5sum ở đâu bằng `whereis md5sum` -> `/usr/bin/md5sum`  
Nhìn vào biến PATH: `/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:...`. Thấy rằng để đến được `md5sum`, hệ thống sẽ phải đi qua 3 folder là `/usr/local/sbin`, `/usr/local/bin` và `/usr/sbin`  
Ý tưởng là ta sẽ tạo 1 file md5sum khác thực thi được ở 1 trong 3 folder này, hệ thống khi đó sẽ chạy file của ta trước file md5sum thật sự.  
Thấy có `/usr/local/bin` là ta có quyền ghi.  
Tra google xem có cách nào ghi file mà không cần redirect thì tìm thấy lệnh tee rất hữu ích: `echo "cat /root/flag.txt" | tee -a /usr/local/bin/md5sum`  
Sau đó `chmod +x` cho `/usr/local/bin/md5sum` và chạy binary `flaghasher`
## Flag
```
picoCTF{Co-@utH0r_Of_Sy5tem_b!n@riEs_5547c7aa}
```